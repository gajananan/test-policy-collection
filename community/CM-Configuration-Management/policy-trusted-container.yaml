apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-trusted-container
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-2 Baseline Configuration
    integrityshield.io/message: H4sIAAAAAAAAA41UTW/bMAy9+1cIOVdZ22HA4FubDkUPHYqk2GXogbboVIu+JslejGH/fZQTO3GaNtHJlshH8j2S4OQP9EFakzNnlSzbqXVoeKnqENFzDQaWqNHEqbSfmqtsJY3I2VNnmmmMICBCnjFmQGOPwaNP7oKX1kSQBj0ZgDE2QqRQIdmzM+KFCEaAFyFn3x8Wz2zxxL5eXvIvn8/0LyHi0nqJBDB7ZDNrKrmsfZcEexxMz0WjYrxVHRa/ZrcQUFFtY9gsOCxTfZ78hOzubsrYESxNZb2mNyEDFAqJyApUwIwNvKF2ipLeMsSZLX5hGe+wkkZ2IN19OnCoHFU5lYWellaTUKDcK1wN1hvZnjeyzHpVtjL2Rvty9mcjK66BEsNe10FWNwboax/+sUEvY5szZf8cgAYHJS5QUXnW7zsx4okEEBT250RgBbWKk5eRAa4Hg1VdIA8tZaVHRh/RP8TRpO4clzJETzn+rqElnTPOefaG3TPnQlFR6faWfqVZHpmQYvPC350U12PMsdobrP72fcde5SGJea1Sb1Et997WLqcvFz6oIwt1125d9/HTEz0E3HXBLtZJ1t7wfCK7Iyx3BR5ZQqe56jt1G4kmQsi91cQZrZ5Y06hPaGZwsm2a2DqC3ywOMTtwvWlAqjTWO9hxe2uI5eu3tfMYwi5UCvZ3hdR/aBrprUmJXzDigRYKubIHc8EaUHVaYmkgmsnLv+w/OBlpXLgFAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUVVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9kNWd3d0FnZ1FtMDdUa0FCcVk5VWdoNHNZbEljQTFEZnBGMExadAoyR3RQdVRjYlN1OHZTdmV1M0NqSzI3YWV6YjZ3VXdpZUdtN01FcHFneGtiNE9WZlpIclpJdTY0RWdCSVlhNjNpCkFFc09WUXJnN21kWjZXeDM1WE4wMFRqSXhxbXE1empybS9iL2UzRE9vTk83MU00VUdmbEhOK0JPS0Y5bkRUT2cKS3k4dnZKRzAzdEo1aTg2bzRwQVE3TFpuNWlkSjlkSGFOSHZ3bzF3emR3azBIaDNoY2JvelNuOHBGZzhxNHN0awoyeW4zQ3ozYTNSOWZ0UTZBaEpvY1JKNDAwazdoRXNZalpUa05TaWlsTTU5RDFmcnl3SjRBSjNwUzVwdGI1M3lzCi9QSXc3SFlhdXZBZjNkL2lwVGNkbHgzVm9xdUdFR01xUzBDaWh5dm9ndFFYSnRySVBGZEFWbFBkdVRDenBmcFIKL2djOG9SSWZsTmZkVFhoeWpMODRROVdkT29vS0NwRTZxODh6Ymp3U1Y1aFN4dGxJNndCMk52MGs3WXRlVER6Mwp2NXpZMnRCRFc5dEhSNEdCWEE1WEhsQXZXck40bFFzVEFSSGpTcEdCbGhYemVSMHYybVdiNEhLMEhrc2g3YWZpCmFBQlpNN3BDQUJRN0dSaHpNUVZCaGxLR0RadVE4RmF6Cj1GQ0Z4Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policies.ibm.com/v1alpha1
        kind: TrustedContainerPolicy
        metadata:
          name: example-trustedcontainerpolicy
        spec:
          severity: low
          namespaceSelector:
            include: ["default"]
            exclude: ["kube-system"]
          remediationAction: inform
          imageRegistry: quay.io
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-trusted-container
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA41UTW/bMAy9+1cIOVdZ22HA4FubDkUPHYqk2GXogbboVIu+JslejGH/fZQTO3GaNtHJlshH8j2S4OQP9EFakzNnlSzbqXVoeKnqENFzDQaWqNHEqbSfmqtsJY3I2VNnmmmMICBCnjFmQGOPwaNP7oKX1kSQBj0ZgDE2QqRQIdmzM+KFCEaAFyFn3x8Wz2zxxL5eXvIvn8/0LyHi0nqJBDB7ZDNrKrmsfZcEexxMz0WjYrxVHRa/ZrcQUFFtY9gsOCxTfZ78hOzubsrYESxNZb2mNyEDFAqJyApUwIwNvKF2ipLeMsSZLX5hGe+wkkZ2IN19OnCoHFU5lYWellaTUKDcK1wN1hvZnjeyzHpVtjL2Rvty9mcjK66BEsNe10FWNwboax/+sUEvY5szZf8cgAYHJS5QUXnW7zsx4okEEBT250RgBbWKk5eRAa4Hg1VdIA8tZaVHRh/RP8TRpO4clzJETzn+rqElnTPOefaG3TPnQlFR6faWfqVZHpmQYvPC350U12PMsdobrP72fcde5SGJea1Sb1Et997WLqcvFz6oIwt1125d9/HTEz0E3HXBLtZJ1t7wfCK7Iyx3BR5ZQqe56jt1G4kmQsi91cQZrZ5Y06hPaGZwsm2a2DqC3ywOMTtwvWlAqjTWO9hxe2uI5eu3tfMYwi5UCvZ3hdR/aBrprUmJXzDigRYKubIHc8EaUHVaYmkgmsnLv+w/OBlpXLgFAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUVVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9kNWd3d0FnZ1FtMDdUa0FCcVk5VWdoNHNZbEljQTFEZnBGMExadAoyR3RQdVRjYlN1OHZTdmV1M0NqSzI3YWV6YjZ3VXdpZUdtN01FcHFneGtiNE9WZlpIclpJdTY0RWdCSVlhNjNpCkFFc09WUXJnN21kWjZXeDM1WE4wMFRqSXhxbXE1empybS9iL2UzRE9vTk83MU00VUdmbEhOK0JPS0Y5bkRUT2cKS3k4dnZKRzAzdEo1aTg2bzRwQVE3TFpuNWlkSjlkSGFOSHZ3bzF3emR3azBIaDNoY2JvelNuOHBGZzhxNHN0awoyeW4zQ3ozYTNSOWZ0UTZBaEpvY1JKNDAwazdoRXNZalpUa05TaWlsTTU5RDFmcnl3SjRBSjNwUzVwdGI1M3lzCi9QSXc3SFlhdXZBZjNkL2lwVGNkbHgzVm9xdUdFR01xUzBDaWh5dm9ndFFYSnRySVBGZEFWbFBkdVRDenBmcFIKL2djOG9SSWZsTmZkVFhoeWpMODRROVdkT29vS0NwRTZxODh6Ymp3U1Y1aFN4dGxJNndCMk52MGs3WXRlVER6Mwp2NXpZMnRCRFc5dEhSNEdCWEE1WEhsQXZXck40bFFzVEFSSGpTcEdCbGhYemVSMHYybVdiNEhLMEhrc2g3YWZpCmFBQlpNN3BDQUJRN0dSaHpNUVZCaGxLR0RadVE4RmF6Cj1GQ0Z4Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
placementRef:
  name: placement-policy-trusted-container
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-trusted-container
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-trusted-container
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA41UTW/bMAy9+1cIOVdZ22HA4FubDkUPHYqk2GXogbboVIu+JslejGH/fZQTO3GaNtHJlshH8j2S4OQP9EFakzNnlSzbqXVoeKnqENFzDQaWqNHEqbSfmqtsJY3I2VNnmmmMICBCnjFmQGOPwaNP7oKX1kSQBj0ZgDE2QqRQIdmzM+KFCEaAFyFn3x8Wz2zxxL5eXvIvn8/0LyHi0nqJBDB7ZDNrKrmsfZcEexxMz0WjYrxVHRa/ZrcQUFFtY9gsOCxTfZ78hOzubsrYESxNZb2mNyEDFAqJyApUwIwNvKF2ipLeMsSZLX5hGe+wkkZ2IN19OnCoHFU5lYWellaTUKDcK1wN1hvZnjeyzHpVtjL2Rvty9mcjK66BEsNe10FWNwboax/+sUEvY5szZf8cgAYHJS5QUXnW7zsx4okEEBT250RgBbWKk5eRAa4Hg1VdIA8tZaVHRh/RP8TRpO4clzJETzn+rqElnTPOefaG3TPnQlFR6faWfqVZHpmQYvPC350U12PMsdobrP72fcde5SGJea1Sb1Et997WLqcvFz6oIwt1125d9/HTEz0E3HXBLtZJ1t7wfCK7Iyx3BR5ZQqe56jt1G4kmQsi91cQZrZ5Y06hPaGZwsm2a2DqC3ywOMTtwvWlAqjTWO9hxe2uI5eu3tfMYwi5UCvZ3hdR/aBrprUmJXzDigRYKubIHc8EaUHVaYmkgmsnLv+w/OBlpXLgFAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUVVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9kNWd3d0FnZ1FtMDdUa0FCcVk5VWdoNHNZbEljQTFEZnBGMExadAoyR3RQdVRjYlN1OHZTdmV1M0NqSzI3YWV6YjZ3VXdpZUdtN01FcHFneGtiNE9WZlpIclpJdTY0RWdCSVlhNjNpCkFFc09WUXJnN21kWjZXeDM1WE4wMFRqSXhxbXE1empybS9iL2UzRE9vTk83MU00VUdmbEhOK0JPS0Y5bkRUT2cKS3k4dnZKRzAzdEo1aTg2bzRwQVE3TFpuNWlkSjlkSGFOSHZ3bzF3emR3azBIaDNoY2JvelNuOHBGZzhxNHN0awoyeW4zQ3ozYTNSOWZ0UTZBaEpvY1JKNDAwazdoRXNZalpUa05TaWlsTTU5RDFmcnl3SjRBSjNwUzVwdGI1M3lzCi9QSXc3SFlhdXZBZjNkL2lwVGNkbHgzVm9xdUdFR01xUzBDaWh5dm9ndFFYSnRySVBGZEFWbFBkdVRDenBmcFIKL2djOG9SSWZsTmZkVFhoeWpMODRROVdkT29vS0NwRTZxODh6Ymp3U1Y1aFN4dGxJNndCMk52MGs3WXRlVER6Mwp2NXpZMnRCRFc5dEhSNEdCWEE1WEhsQXZXck40bFFzVEFSSGpTcEdCbGhYemVSMHYybVdiNEhLMEhrc2g3YWZpCmFBQlpNN3BDQUJRN0dSaHpNUVZCaGxLR0RadVE4RmF6Cj1GQ0Z4Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
