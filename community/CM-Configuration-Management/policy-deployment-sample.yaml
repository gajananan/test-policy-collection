apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-deployment
  annotations:
    policy.open-cluster-management.io/standards: NIST 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-2 Baseline Configuration
    integrityshield.io/message: H4sIAAAAAAAAA5VVTW/bMAy9+1cIuRQYqqwfGzD41o9hKLAORVv0MuzA2EyqVZYESfYaDPvvo+QosRPHaXmzRPJR75kkGPGE1gmtcma0FMVyqg0qXsjaebS8AgULrFD5qdAfm9PsRagyZ3fRNavQQwke8owxBRWmHLxEI/UyhNENKKU9eMJwwZG9Ach5UCXY0uXsx83DI/tycsI/n78xuACPC20FUvTVLbvSai4WtY0VsNu161uzaeWtljEXP2OX4FAKhf20mTNYhMdZiitFPLsofKRVqLm2Fd2VwsFMItE3B+kwS+jcY2UkFb2ihzM9+42Fv8a5UCImiefB4L16pcBWt17RKxGTR1fMZD1R1UKo1760raXHJxsjYR2DDVrhlzmT+s8WojNQ4ANK4kDbbmLG8JVeWmL/MFD2Us+Qf+gdC7XHt8Q51NJ3zlvCt4XYRBSaLgSoAh+XhhipiO1naHAr9X7dknX1A2NcV6JkrVTXuzwnG1IqWavYXqk2JmGG0g2lCFWaVY6d622tk1nCEgVQm5wP3LpBMdfvAV88fx+pZ7QixpJse7KPsBVsjIiD0PsJCRZmB9CwsCPpeVeyvV70N1fU2Dk7in756fT00/TsaMTfaOtHYFvodYF35J3TmM0459m7h8xqKUhq23B6SZ9CLQbWw6y94btrwqTge5x31kk6HYhIjbKGva9laEiq/pvVtWkbbKTyzNWxXyNLfGSBrZE2A3MDcpCgHUoPlDVAaHzZwLIdYSf9lisIGvyl6KxgzmjF+pradfJoa5ys/hMfp1u7I8urrdCLBoQMG2yTtj+kYx9/fTUWndtABbC/L0iTHlUjrFahvmNGBNAaolB2o45ZA7IO+/rnpMRm8utf9h/XOBLXmQgAAA==
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUZ1JIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9jclVBdi9heWNOQUxQdHVWQzRsUG9hTkdPUit6V0RjOWpBWGpiOAo1a3A2R0ZRUUlpR3FmRldJVDJOS0ppaCs3OVVlS2YxSWh6WGVBOHA5MzF4NHE3MENCUzZuUCtaNmdZZk5tLzdaCm1vZVl6UnBxNDJNSlJXMWlGRHZQZ0FoSVFLVEJ4UmkrWmJ3d0ZtakhRSk5NSzgwcmk4aG5HKzVwTVlKclRGYWIKTUNjLzFIV0RET2hLRi9FWGV6TDdJSmNvdWsrKzJmQ3JycExSMko3NE5xcGt4SEpYTDdMZGtnaWxmbDNRN3VobQpMdUtSL3V6OXRmd1F1ZFkrK1JtNUJnTGRaTDVHQVNUWG1qVEo1cmZMU3dnaFhlekpYMUJRL2FDVWhmNU1wRStpCmM3dWhoa1o4b1F0TFhDZytLK2lNb3ppMU9ZSXQvQ1l3Um5kQllWTmdTNUdEeTR4V09uL242VnM5cmRDb3hLTWkKMC9YL3NWZHV6T0lmNTY0SnFLcFE4b0FIZ1BFdDFacTNLS1g5cWllTHpsZmt1dS81QkY0RlBCbUF0WUpydm5udwo3Z1dIaWdaMFB1MFk4Umx3cFhUU2RlZTNzMU92ODZ3b2lNRmdMNUVUblN4Y1p5ZWtsV25pYVNOY1VZZFNTd1B2CjZ0RGlPbXNsMUgySjVKK3pKbjU5UC9aQUlrMHJaVVdlCj1yK1N5Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-nginx-deployment
        spec:
          remediationAction: inform
          severity: low
          namespaceSelector:
            exclude:
              - kube-*
            include:
              - default
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: apps/v1
                kind: Deployment
                metadata:
                  name: nginx-deployment
                  labels:
                    app: nginx
                spec:
                  replicas: 3
                  selector:
                    matchLabels:
                      app: nginx
                  template:
                    metadata:
                      labels:
                        app: nginx
                    spec:
                      containers:
                        - name: nginx
                          image: 'nginx:1.14.2'
                          ports:
                            - containerPort: 80
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-deployment
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VVTW/bMAy9+1cIuRQYqqwfGzD41o9hKLAORVv0MuzA2EyqVZYESfYaDPvvo+QosRPHaXmzRPJR75kkGPGE1gmtcma0FMVyqg0qXsjaebS8AgULrFD5qdAfm9PsRagyZ3fRNavQQwke8owxBRWmHLxEI/UyhNENKKU9eMJwwZG9Ach5UCXY0uXsx83DI/tycsI/n78xuACPC20FUvTVLbvSai4WtY0VsNu161uzaeWtljEXP2OX4FAKhf20mTNYhMdZiitFPLsofKRVqLm2Fd2VwsFMItE3B+kwS+jcY2UkFb2ihzM9+42Fv8a5UCImiefB4L16pcBWt17RKxGTR1fMZD1R1UKo1760raXHJxsjYR2DDVrhlzmT+s8WojNQ4ANK4kDbbmLG8JVeWmL/MFD2Us+Qf+gdC7XHt8Q51NJ3zlvCt4XYRBSaLgSoAh+XhhipiO1naHAr9X7dknX1A2NcV6JkrVTXuzwnG1IqWavYXqk2JmGG0g2lCFWaVY6d622tk1nCEgVQm5wP3LpBMdfvAV88fx+pZ7QixpJse7KPsBVsjIiD0PsJCRZmB9CwsCPpeVeyvV70N1fU2Dk7in756fT00/TsaMTfaOtHYFvodYF35J3TmM0459m7h8xqKUhq23B6SZ9CLQbWw6y94btrwqTge5x31kk6HYhIjbKGva9laEiq/pvVtWkbbKTyzNWxXyNLfGSBrZE2A3MDcpCgHUoPlDVAaHzZwLIdYSf9lisIGvyl6KxgzmjF+pradfJoa5ys/hMfp1u7I8urrdCLBoQMG2yTtj+kYx9/fTUWndtABbC/L0iTHlUjrFahvmNGBNAaolB2o45ZA7IO+/rnpMRm8utf9h/XOBLXmQgAAA==
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUZ1JIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9jclVBdi9heWNOQUxQdHVWQzRsUG9hTkdPUit6V0RjOWpBWGpiOAo1a3A2R0ZRUUlpR3FmRldJVDJOS0ppaCs3OVVlS2YxSWh6WGVBOHA5MzF4NHE3MENCUzZuUCtaNmdZZk5tLzdaCm1vZVl6UnBxNDJNSlJXMWlGRHZQZ0FoSVFLVEJ4UmkrWmJ3d0ZtakhRSk5NSzgwcmk4aG5HKzVwTVlKclRGYWIKTUNjLzFIV0RET2hLRi9FWGV6TDdJSmNvdWsrKzJmQ3JycExSMko3NE5xcGt4SEpYTDdMZGtnaWxmbDNRN3VobQpMdUtSL3V6OXRmd1F1ZFkrK1JtNUJnTGRaTDVHQVNUWG1qVEo1cmZMU3dnaFhlekpYMUJRL2FDVWhmNU1wRStpCmM3dWhoa1o4b1F0TFhDZytLK2lNb3ppMU9ZSXQvQ1l3Um5kQllWTmdTNUdEeTR4V09uL242VnM5cmRDb3hLTWkKMC9YL3NWZHV6T0lmNTY0SnFLcFE4b0FIZ1BFdDFacTNLS1g5cWllTHpsZmt1dS81QkY0RlBCbUF0WUpydm5udwo3Z1dIaWdaMFB1MFk4Umx3cFhUU2RlZTNzMU92ODZ3b2lNRmdMNUVUblN4Y1p5ZWtsV25pYVNOY1VZZFNTd1B2CjZ0RGlPbXNsMUgySjVKK3pKbjU5UC9aQUlrMHJaVVdlCj1yK1N5Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
placementRef:
  name: placement-policy-deployment
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-deployment
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-deployment
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VVTW/bMAy9+1cIuRQYqqwfGzD41o9hKLAORVv0MuzA2EyqVZYESfYaDPvvo+QosRPHaXmzRPJR75kkGPGE1gmtcma0FMVyqg0qXsjaebS8AgULrFD5qdAfm9PsRagyZ3fRNavQQwke8owxBRWmHLxEI/UyhNENKKU9eMJwwZG9Ach5UCXY0uXsx83DI/tycsI/n78xuACPC20FUvTVLbvSai4WtY0VsNu161uzaeWtljEXP2OX4FAKhf20mTNYhMdZiitFPLsofKRVqLm2Fd2VwsFMItE3B+kwS+jcY2UkFb2ihzM9+42Fv8a5UCImiefB4L16pcBWt17RKxGTR1fMZD1R1UKo1760raXHJxsjYR2DDVrhlzmT+s8WojNQ4ANK4kDbbmLG8JVeWmL/MFD2Us+Qf+gdC7XHt8Q51NJ3zlvCt4XYRBSaLgSoAh+XhhipiO1naHAr9X7dknX1A2NcV6JkrVTXuzwnG1IqWavYXqk2JmGG0g2lCFWaVY6d622tk1nCEgVQm5wP3LpBMdfvAV88fx+pZ7QixpJse7KPsBVsjIiD0PsJCRZmB9CwsCPpeVeyvV70N1fU2Dk7in756fT00/TsaMTfaOtHYFvodYF35J3TmM0459m7h8xqKUhq23B6SZ9CLQbWw6y94btrwqTge5x31kk6HYhIjbKGva9laEiq/pvVtWkbbKTyzNWxXyNLfGSBrZE2A3MDcpCgHUoPlDVAaHzZwLIdYSf9lisIGvyl6KxgzmjF+pradfJoa5ys/hMfp1u7I8urrdCLBoQMG2yTtj+kYx9/fTUWndtABbC/L0iTHlUjrFahvmNGBNAaolB2o45ZA7IO+/rnpMRm8utf9h/XOBLXmQgAAA==
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUZ1JIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9jclVBdi9heWNOQUxQdHVWQzRsUG9hTkdPUit6V0RjOWpBWGpiOAo1a3A2R0ZRUUlpR3FmRldJVDJOS0ppaCs3OVVlS2YxSWh6WGVBOHA5MzF4NHE3MENCUzZuUCtaNmdZZk5tLzdaCm1vZVl6UnBxNDJNSlJXMWlGRHZQZ0FoSVFLVEJ4UmkrWmJ3d0ZtakhRSk5NSzgwcmk4aG5HKzVwTVlKclRGYWIKTUNjLzFIV0RET2hLRi9FWGV6TDdJSmNvdWsrKzJmQ3JycExSMko3NE5xcGt4SEpYTDdMZGtnaWxmbDNRN3VobQpMdUtSL3V6OXRmd1F1ZFkrK1JtNUJnTGRaTDVHQVNUWG1qVEo1cmZMU3dnaFhlekpYMUJRL2FDVWhmNU1wRStpCmM3dWhoa1o4b1F0TFhDZytLK2lNb3ppMU9ZSXQvQ1l3Um5kQllWTmdTNUdEeTR4V09uL242VnM5cmRDb3hLTWkKMC9YL3NWZHV6T0lmNTY0SnFLcFE4b0FIZ1BFdDFacTNLS1g5cWllTHpsZmt1dS81QkY0RlBCbUF0WUpydm5udwo3Z1dIaWdaMFB1MFk4Umx3cFhUU2RlZTNzMU92ODZ3b2lNRmdMNUVUblN4Y1p5ZWtsV25pYVNOY1VZZFNTd1B2CjZ0RGlPbXNsMUgySjVKK3pKbjU5UC9aQUlrMHJaVVdlCj1yK1N5Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
