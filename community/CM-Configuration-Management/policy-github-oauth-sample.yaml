apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-github-oauth
  namespace: default
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-2 Baseline Configuration
    integrityshield.io/message: H4sIAAAAAAAAA+1WTXPTMBC9+1docmSqUmCYYXxL00ybQ2kmCVwYDoq9SURlyUiyaWH476xkK7Fdu0mHCwf2lEj7oX1vd70s559BG65kTHIlePJ4rnKQNBGFsaBpxiTbQgbSnnP1unwT3XOZxmTuVaMMLEuZZXFEiGQZBB90y+2uWFPFCrur70zOElRIYcMKYfGQSakssxjaOHtyQnxjmUyZTk1MPs6WK7Kckw8XF/T9uxPtE2ZhqzQHdDC5JRMlN3xbaP8IcrtXPdWbklYr4X3Rt+SSGRBcQtttZHJIXH4a7VLuz8aJ9YBzuVE6w7uUG7YWgMBumDAQhejUQpYLfHSNECVq/Q0SewUbLrl34s+dsJcyGQwrRluPrukNGk2ag1R0d3iuJGQc5LnM9zZQgub2MSZC/eiE8ZWzBIGJK910TAg8YHoptA8dTvfFGuir1jGXA7qHkgxSodxF/2CRKLzgTCaweswRhgwh3rESOq6HyQrSJC3xDHjSzI5vujQFqei6GzcRD9JHVJCKsLoantx3OQvCUywY5GWuVYm/telTcpBUldB/6yQRHD3NrmIyuzqitIREgx121S6+QTWlt0zyn80J0y/YVf2NMmCTsTzncnsLdqdSBynj2YDqCQ+1voKuub2pVf7FJqeuy43n5X+b/12bD7b0sg1vkOM9PVhejc/ufqrQasw80a7K8C5n34tufvh9Gojf6lcy/7RaTieL6epmuphGlNLoxeVabxcC3+xOL/EvdlrPnrGubujJ+0YefC5g01hXwumAo857FoVw4GBa11oVeYy/cvNMSpEpfG34yqLPrkj7WIeuPIQ5it0TtI88rAdrn1vPQncEoR6ow2CoI+PQSXljCFOCa5wtcG0arXQBo6hZgNUSlk46puOSceFWpIPb9qTImE1204dcgzHNeU/Jr3vAcQOy5FpJl8iZawYcgWhKZvKMlEwUbiH8MkqhHH39Hf0B4u7mURQLAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUTVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9mUkl3di9mZGZjeEFPNGN2Q3cxdWN6dWdmZ1BmNTdLRzE2UFcyagoxQ2lJb1Bra0xwamtNYTZlUnZvSW5VSUhYWjdwUC85OXlYVUdGby9VcUwxbkZjTkpFQ1ZhZXpDS1BRU1d5TTdnCmN4ZHhuUTlmRHhmeTdWRmRCRG4wenlLM2VyZHp3UFQ4SVpPSkExNHp0Z1M2QXVmVmdrcGVqVDRrQXdHa3VHbWoKTm5IQi9WRzQ0cFJYR3NRNHFDUHFKanFmeXEzWUtSV3huUnZBU3psTXlGN01XNGtBUmxPVEY3bU9VUDJrR1hCagpkMmhGellCemcrNThlcldLT2IvQTkwSFRlVlNjcnkvQ2l6Tlp3Y2g3VzlNSUJhM01kdzNxZytiZlFTSGZzOFkrCk5NU2pyWVdDYVNCOXFCZ3g5K3ZDYTFsM0xHbFc3N1BOQ2JRNkMzc2FtMkswM3piSXhnNSt6NjBidjkzVHlwSVoKOTlRNnhqZ2ZyWHcvVVU3V1RaeXZhQUpxWUVKMmVGUnpDdE95cGtqRWNRL0cvTnhJc3d6azNGODdLcWpIM1BGeQo4QmF0c3g4K2x0MVVPMDNHN3hmRVBrdkpvMGNud003SUUvSEtyd1YrU0FSQ1ZuMVdjem5TQjBDK2Z6ZzF6TXd0CkhTUEt5RnhESFpCZ0FFdFZ5ZlhOUzdxdUVLd292b0FrCj1SZEU2Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: github-oauth
        spec:
          remediationAction: inform
          severity: low
          namespaceSelector:
            exclude:
              - kube-*
            include:
              - default
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: config.openshift.io/v1
                kind: OAuth
                metadata:
                  name: cluster
                spec:
                  identityProviders:
                    - github:
                        clientID: ID
                        clientSecret:
                          name: github
                        organizations:
                          - open-cluster-management
                      mappingMethod: claim
                      name: github
                      type: GitHub
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: git-hub-secret
        spec:
          remediationAction: inform
          severity: low
          namespaceSelector:
            exclude:
              - kube-*
            include:
              - default
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                kind: Secret
                metadata:
                  name: github
                  namespace: openshift-config
                type: Opaque
                data:
                  clientSecret: PUTSECRETHERE
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-github-oauth
  namespace: default
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA+1WTXPTMBC9+1docmSqUmCYYXxL00ybQ2kmCVwYDoq9SURlyUiyaWH476xkK7Fdu0mHCwf2lEj7oX1vd70s559BG65kTHIlePJ4rnKQNBGFsaBpxiTbQgbSnnP1unwT3XOZxmTuVaMMLEuZZXFEiGQZBB90y+2uWFPFCrur70zOElRIYcMKYfGQSakssxjaOHtyQnxjmUyZTk1MPs6WK7Kckw8XF/T9uxPtE2ZhqzQHdDC5JRMlN3xbaP8IcrtXPdWbklYr4X3Rt+SSGRBcQtttZHJIXH4a7VLuz8aJ9YBzuVE6w7uUG7YWgMBumDAQhejUQpYLfHSNECVq/Q0SewUbLrl34s+dsJcyGQwrRluPrukNGk2ag1R0d3iuJGQc5LnM9zZQgub2MSZC/eiE8ZWzBIGJK910TAg8YHoptA8dTvfFGuir1jGXA7qHkgxSodxF/2CRKLzgTCaweswRhgwh3rESOq6HyQrSJC3xDHjSzI5vujQFqei6GzcRD9JHVJCKsLoantx3OQvCUywY5GWuVYm/telTcpBUldB/6yQRHD3NrmIyuzqitIREgx121S6+QTWlt0zyn80J0y/YVf2NMmCTsTzncnsLdqdSBynj2YDqCQ+1voKuub2pVf7FJqeuy43n5X+b/12bD7b0sg1vkOM9PVhejc/ufqrQasw80a7K8C5n34tufvh9Gojf6lcy/7RaTieL6epmuphGlNLoxeVabxcC3+xOL/EvdlrPnrGubujJ+0YefC5g01hXwumAo857FoVw4GBa11oVeYy/cvNMSpEpfG34yqLPrkj7WIeuPIQ5it0TtI88rAdrn1vPQncEoR6ow2CoI+PQSXljCFOCa5wtcG0arXQBo6hZgNUSlk46puOSceFWpIPb9qTImE1204dcgzHNeU/Jr3vAcQOy5FpJl8iZawYcgWhKZvKMlEwUbiH8MkqhHH39Hf0B4u7mURQLAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUTVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9mUkl3di9mZGZjeEFPNGN2Q3cxdWN6dWdmZ1BmNTdLRzE2UFcyagoxQ2lJb1Bra0xwamtNYTZlUnZvSW5VSUhYWjdwUC85OXlYVUdGby9VcUwxbkZjTkpFQ1ZhZXpDS1BRU1d5TTdnCmN4ZHhuUTlmRHhmeTdWRmRCRG4wenlLM2VyZHp3UFQ4SVpPSkExNHp0Z1M2QXVmVmdrcGVqVDRrQXdHa3VHbWoKTm5IQi9WRzQ0cFJYR3NRNHFDUHFKanFmeXEzWUtSV3huUnZBU3psTXlGN01XNGtBUmxPVEY3bU9VUDJrR1hCagpkMmhGellCemcrNThlcldLT2IvQTkwSFRlVlNjcnkvQ2l6Tlp3Y2g3VzlNSUJhM01kdzNxZytiZlFTSGZzOFkrCk5NU2pyWVdDYVNCOXFCZ3g5K3ZDYTFsM0xHbFc3N1BOQ2JRNkMzc2FtMkswM3piSXhnNSt6NjBidjkzVHlwSVoKOTlRNnhqZ2ZyWHcvVVU3V1RaeXZhQUpxWUVKMmVGUnpDdE95cGtqRWNRL0cvTnhJc3d6azNGODdLcWpIM1BGeQo4QmF0c3g4K2x0MVVPMDNHN3hmRVBrdkpvMGNud003SUUvSEtyd1YrU0FSQ1ZuMVdjem5TQjBDK2Z6ZzF6TXd0CkhTUEt5RnhESFpCZ0FFdFZ5ZlhOUzdxdUVLd292b0FrCj1SZEU2Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
placementRef:
  name: placement-policy-github-oauth
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-github-oauth
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-github-oauth
  namespace: default
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA+1WTXPTMBC9+1docmSqUmCYYXxL00ybQ2kmCVwYDoq9SURlyUiyaWH476xkK7Fdu0mHCwf2lEj7oX1vd70s559BG65kTHIlePJ4rnKQNBGFsaBpxiTbQgbSnnP1unwT3XOZxmTuVaMMLEuZZXFEiGQZBB90y+2uWFPFCrur70zOElRIYcMKYfGQSakssxjaOHtyQnxjmUyZTk1MPs6WK7Kckw8XF/T9uxPtE2ZhqzQHdDC5JRMlN3xbaP8IcrtXPdWbklYr4X3Rt+SSGRBcQtttZHJIXH4a7VLuz8aJ9YBzuVE6w7uUG7YWgMBumDAQhejUQpYLfHSNECVq/Q0SewUbLrl34s+dsJcyGQwrRluPrukNGk2ag1R0d3iuJGQc5LnM9zZQgub2MSZC/eiE8ZWzBIGJK910TAg8YHoptA8dTvfFGuir1jGXA7qHkgxSodxF/2CRKLzgTCaweswRhgwh3rESOq6HyQrSJC3xDHjSzI5vujQFqei6GzcRD9JHVJCKsLoantx3OQvCUywY5GWuVYm/telTcpBUldB/6yQRHD3NrmIyuzqitIREgx121S6+QTWlt0zyn80J0y/YVf2NMmCTsTzncnsLdqdSBynj2YDqCQ+1voKuub2pVf7FJqeuy43n5X+b/12bD7b0sg1vkOM9PVhejc/ufqrQasw80a7K8C5n34tufvh9Gojf6lcy/7RaTieL6epmuphGlNLoxeVabxcC3+xOL/EvdlrPnrGubujJ+0YefC5g01hXwumAo857FoVw4GBa11oVeYy/cvNMSpEpfG34yqLPrkj7WIeuPIQ5it0TtI88rAdrn1vPQncEoR6ow2CoI+PQSXljCFOCa5wtcG0arXQBo6hZgNUSlk46puOSceFWpIPb9qTImE1204dcgzHNeU/Jr3vAcQOy5FpJl8iZawYcgWhKZvKMlEwUbiH8MkqhHH39Hf0B4u7mURQLAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUTVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9mUkl3di9mZGZjeEFPNGN2Q3cxdWN6dWdmZ1BmNTdLRzE2UFcyagoxQ2lJb1Bra0xwamtNYTZlUnZvSW5VSUhYWjdwUC85OXlYVUdGby9VcUwxbkZjTkpFQ1ZhZXpDS1BRU1d5TTdnCmN4ZHhuUTlmRHhmeTdWRmRCRG4wenlLM2VyZHp3UFQ4SVpPSkExNHp0Z1M2QXVmVmdrcGVqVDRrQXdHa3VHbWoKTm5IQi9WRzQ0cFJYR3NRNHFDUHFKanFmeXEzWUtSV3huUnZBU3psTXlGN01XNGtBUmxPVEY3bU9VUDJrR1hCagpkMmhGellCemcrNThlcldLT2IvQTkwSFRlVlNjcnkvQ2l6Tlp3Y2g3VzlNSUJhM01kdzNxZytiZlFTSGZzOFkrCk5NU2pyWVdDYVNCOXFCZ3g5K3ZDYTFsM0xHbFc3N1BOQ2JRNkMzc2FtMkswM3piSXhnNSt6NjBidjkzVHlwSVoKOTlRNnhqZ2ZyWHcvVVU3V1RaeXZhQUpxWUVKMmVGUnpDdE95cGtqRWNRL0cvTnhJc3d6azNGODdLcWpIM1BGeQo4QmF0c3g4K2x0MVVPMDNHN3hmRVBrdkpvMGNud003SUUvSEtyd1YrU0FSQ1ZuMVdjem5TQjBDK2Z6ZzF6TXd0CkhTUEt5RnhESFpCZ0FFdFZ5ZlhOUzdxdUVLd292b0FrCj1SZEU2Ci0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
