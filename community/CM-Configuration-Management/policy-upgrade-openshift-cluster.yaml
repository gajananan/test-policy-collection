apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: upgrade-cluster
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-2 Baseline Configuration
    integrityshield.io/message: H4sIAAAAAAAAA5VVyW7bMBC96ysIXwwEoZ02DVDolrhFkUOKIE5zKYqCFkcWa4okSEqIUfTfO5REW5aXOHOSRm+2N4uYES9gndAqJUZLka0n2oCimaycB0tLptgSSlB+IvS0/pCshOIpeWygSQmeceZZmhCiWAkpqczSMg7RHvVMKe2ZxwguwMgZYZxnijPLXUq+38+fyfyRfL66ojfXZ9pnzMNSWwHoYPZAZlrlYlnZJgnysIGe600rb7VsfNGP5I45kELBrtvEGchCfVw4tpCAHOVMOkhiBOqhNBIT61igRC/+QOa/QC6UCC5afRD23qZEw7Y5O4l1nYqIfseiHOtcK7GwPtoZlsEcJOavbf8jIfCKDjjsKkO5q2oB9GJHLdQR7Phi3NO1RA0J3KIzjR8EUxk8rw1WUmIBBath4PY434d4zxoSG95dIfIh01E6xlvOOuM90CHSo7Tk10csh+RHyQpcK5ApwVXBaaOfJjcHUBycsMB/GAy+x3IrdawXPUyuD0Aq47wFVqZkXHhvXDqdIk09XpD9oJl28+N+C5UHqqb4aop+Hy2OLBfNVN5mTQdIwNqyh3GAGQm/TkkhlkVyyohSmrx7U7rzJXF+g/YOX4VaHjhki/YLHa6FiaZPkG/RG+0ePo7IJuRTJcNkYubfrK5Mik/Gncg6cVUzuM3Y0xPLunOZg2Ib4k1q9sh8I6kDVDZ17fN4nJk42907Xi0uer8JGmbbV3h2R8+2glE3JL5Z8faI89nA9LZmQoaF2LrdvVIl81nx9dVYcG4bKgT7uwIcOlC1sFqFfC8Jlo83FE3JvbokNZNV+KH8HHGoR7/+Jf8BiXauajsHAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUTVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9jd0dBditQREE0SU9GR3pkSjN6SVU0N2k2OEFiS1BpaTYrVFJoRgo3OEpNSnpHZTRadE1LckNSZVhQQjEwenpNVE1JbXdYVlJvcGNHY21FMDA2b1NXZHNkcVZ5SHNjR1o5d0lySDFJClkwOFJiWHNYSlJpS1EyVVEwS2RWTkp4eEg5c1VCcGVqMVdpN3Y4bEZ3YU95empDUThuUDFNdXd1YWRuL2VLWisKS1dBVDI4cFlDZG4ybDNUK2tKOUxNUkY4OEpqc1ErK1Y0TERaalRTbUhMOWxidUNYemFCZnZTR21JK25oR003ZgpkNjBvNGlaN0NEV3QzOHV1WGZsc2Rhck8xTENpMWxNYzl2SWk3RHNYV3hBUzB0NFlqcC9FKzVxNUxPb2hwRTBKCmpyRnpoL0w0RGkwZS9HZnd2QUhDQ0RuVnYvVDJOME1JNHB2T2lWcTJKYWlETGp2NFdWMlpVK3lxbnZYbDZqWlIKdWhidEpTclVzQ2dxZFBnWmRxbWhNQ2Zab3dZQnBZUHowd25CdzFyQnY2WDZZeHlLV01XWGhiK3E4Y1FUS3U3VQppS3ZncnNkbWhnbC9GdW5iUkdWUHhuMmpNL3h0eTVlK29ha2hWWExsRWpva1Qyc2orZXBDL0JDdFA4UlNPSWNCCm5YSlZZRGY0QzdrYXZRblZzeXV0T1luOHlKNURYTHlFCj0vbjUxCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: upgrade-cluster
        spec:
          namespaceSelector:
            exclude:
              - kube-*
            include:
              - '*'
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: config.openshift.io/v1
                kind: ClusterVersion
                metadata:
                  name: version
                spec:
                  channel: stable-4.5
                  desiredUpdate:
                    version: 4.5.3
                  upstream: 'https://api.openshift.com/api/upgrades_info/v1/graph'
          remediationAction: inform
          severity: high
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-upgrade-cluster
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VVyW7bMBC96ysIXwwEoZ02DVDolrhFkUOKIE5zKYqCFkcWa4okSEqIUfTfO5REW5aXOHOSRm+2N4uYES9gndAqJUZLka0n2oCimaycB0tLptgSSlB+IvS0/pCshOIpeWygSQmeceZZmhCiWAkpqczSMg7RHvVMKe2ZxwguwMgZYZxnijPLXUq+38+fyfyRfL66ojfXZ9pnzMNSWwHoYPZAZlrlYlnZJgnysIGe600rb7VsfNGP5I45kELBrtvEGchCfVw4tpCAHOVMOkhiBOqhNBIT61igRC/+QOa/QC6UCC5afRD23qZEw7Y5O4l1nYqIfseiHOtcK7GwPtoZlsEcJOavbf8jIfCKDjjsKkO5q2oB9GJHLdQR7Phi3NO1RA0J3KIzjR8EUxk8rw1WUmIBBath4PY434d4zxoSG95dIfIh01E6xlvOOuM90CHSo7Tk10csh+RHyQpcK5ApwVXBaaOfJjcHUBycsMB/GAy+x3IrdawXPUyuD0Aq47wFVqZkXHhvXDqdIk09XpD9oJl28+N+C5UHqqb4aop+Hy2OLBfNVN5mTQdIwNqyh3GAGQm/TkkhlkVyyohSmrx7U7rzJXF+g/YOX4VaHjhki/YLHa6FiaZPkG/RG+0ePo7IJuRTJcNkYubfrK5Mik/Gncg6cVUzuM3Y0xPLunOZg2Ib4k1q9sh8I6kDVDZ17fN4nJk42907Xi0uer8JGmbbV3h2R8+2glE3JL5Z8faI89nA9LZmQoaF2LrdvVIl81nx9dVYcG4bKgT7uwIcOlC1sFqFfC8Jlo83FE3JvbokNZNV+KH8HHGoR7/+Jf8BiXauajsHAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUTVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9jd0dBditQREE0SU9GR3pkSjN6SVU0N2k2OEFiS1BpaTYrVFJoRgo3OEpNSnpHZTRadE1LckNSZVhQQjEwenpNVE1JbXdYVlJvcGNHY21FMDA2b1NXZHNkcVZ5SHNjR1o5d0lySDFJClkwOFJiWHNYSlJpS1EyVVEwS2RWTkp4eEg5c1VCcGVqMVdpN3Y4bEZ3YU95empDUThuUDFNdXd1YWRuL2VLWisKS1dBVDI4cFlDZG4ybDNUK2tKOUxNUkY4OEpqc1ErK1Y0TERaalRTbUhMOWxidUNYemFCZnZTR21JK25oR003ZgpkNjBvNGlaN0NEV3QzOHV1WGZsc2Rhck8xTENpMWxNYzl2SWk3RHNYV3hBUzB0NFlqcC9FKzVxNUxPb2hwRTBKCmpyRnpoL0w0RGkwZS9HZnd2QUhDQ0RuVnYvVDJOME1JNHB2T2lWcTJKYWlETGp2NFdWMlpVK3lxbnZYbDZqWlIKdWhidEpTclVzQ2dxZFBnWmRxbWhNQ2Zab3dZQnBZUHowd25CdzFyQnY2WDZZeHlLV01XWGhiK3E4Y1FUS3U3VQppS3ZncnNkbWhnbC9GdW5iUkdWUHhuMmpNL3h0eTVlK29ha2hWWExsRWpva1Qyc2orZXBDL0JDdFA4UlNPSWNCCm5YSlZZRGY0QzdrYXZRblZzeXV0T1luOHlKNURYTHlFCj0vbjUxCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
placementRef:
  name: placement-upgrade-cluster
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: upgrade-cluster
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-upgrade-cluster
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VVyW7bMBC96ysIXwwEoZ02DVDolrhFkUOKIE5zKYqCFkcWa4okSEqIUfTfO5REW5aXOHOSRm+2N4uYES9gndAqJUZLka0n2oCimaycB0tLptgSSlB+IvS0/pCshOIpeWygSQmeceZZmhCiWAkpqczSMg7RHvVMKe2ZxwguwMgZYZxnijPLXUq+38+fyfyRfL66ojfXZ9pnzMNSWwHoYPZAZlrlYlnZJgnysIGe600rb7VsfNGP5I45kELBrtvEGchCfVw4tpCAHOVMOkhiBOqhNBIT61igRC/+QOa/QC6UCC5afRD23qZEw7Y5O4l1nYqIfseiHOtcK7GwPtoZlsEcJOavbf8jIfCKDjjsKkO5q2oB9GJHLdQR7Phi3NO1RA0J3KIzjR8EUxk8rw1WUmIBBath4PY434d4zxoSG95dIfIh01E6xlvOOuM90CHSo7Tk10csh+RHyQpcK5ApwVXBaaOfJjcHUBycsMB/GAy+x3IrdawXPUyuD0Aq47wFVqZkXHhvXDqdIk09XpD9oJl28+N+C5UHqqb4aop+Hy2OLBfNVN5mTQdIwNqyh3GAGQm/TkkhlkVyyohSmrx7U7rzJXF+g/YOX4VaHjhki/YLHa6FiaZPkG/RG+0ePo7IJuRTJcNkYubfrK5Mik/Gncg6cVUzuM3Y0xPLunOZg2Ib4k1q9sh8I6kDVDZ17fN4nJk42907Xi0uer8JGmbbV3h2R8+2glE3JL5Z8faI89nA9LZmQoaF2LrdvVIl81nx9dVYcG4bKgT7uwIcOlC1sFqFfC8Jlo83FE3JvbokNZNV+KH8HHGoR7/+Jf8BiXauajsHAAA=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUTVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9jd0dBditQREE0SU9GR3pkSjN6SVU0N2k2OEFiS1BpaTYrVFJoRgo3OEpNSnpHZTRadE1LckNSZVhQQjEwenpNVE1JbXdYVlJvcGNHY21FMDA2b1NXZHNkcVZ5SHNjR1o5d0lySDFJClkwOFJiWHNYSlJpS1EyVVEwS2RWTkp4eEg5c1VCcGVqMVdpN3Y4bEZ3YU95empDUThuUDFNdXd1YWRuL2VLWisKS1dBVDI4cFlDZG4ybDNUK2tKOUxNUkY4OEpqc1ErK1Y0TERaalRTbUhMOWxidUNYemFCZnZTR21JK25oR003ZgpkNjBvNGlaN0NEV3QzOHV1WGZsc2Rhck8xTENpMWxNYzl2SWk3RHNYV3hBUzB0NFlqcC9FKzVxNUxPb2hwRTBKCmpyRnpoL0w0RGkwZS9HZnd2QUhDQ0RuVnYvVDJOME1JNHB2T2lWcTJKYWlETGp2NFdWMlpVK3lxbnZYbDZqWlIKdWhidEpTclVzQ2dxZFBnWmRxbWhNQ2Zab3dZQnBZUHowd25CdzFyQnY2WDZZeHlLV01XWGhiK3E4Y1FUS3U3VQppS3ZncnNkbWhnbC9GdW5iUkdWUHhuMmpNL3h0eTVlK29ha2hWWExsRWpva1Qyc2orZXBDL0JDdFA4UlNPSWNCCm5YSlZZRGY0QzdrYXZRblZzeXV0T1luOHlKNURYTHlFCj0vbjUxCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
