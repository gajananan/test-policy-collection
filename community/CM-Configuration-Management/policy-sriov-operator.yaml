apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-sriov-operator
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-2 Baseline Configuration
    integrityshield.io/message: H4sIAAAAAAAAA+1Z32/bNhB+919BaG9D5KbbAgx6S9NhCLB4QR10D0MeaOpssaZIgaTcGsP+9x0p0ZZsynaConAH30sb8Xi8H993JE1a8Y+gDVcyI5USnK3HqgKZMlEbCzotqaQLKEHaMVdvVm9HSy7zjDx61VEJlubU0mxEiKQlBBup0VytUrSkqVUaR6mUylKL6xinTE5YzFgqc6pzk5HJ/fSJTB/Jr9fX6c3PJ85n1MJCaQ5o4O6B3Ck554taeyfIw0b1VGtKWq2Et5X+RN5RA4JL6JsdmQqYi0/jvJz7b7fM+uyCnCvNAAdzbuhMAKZxToVxX9qsWSgrgV63KUqJmn0CZt/DnEvurfjvTuhL6xYmNvXred0WM2h0ixokUlxpNuMh6iDD0ZMfiC1gN15vYLw3i3BD1Aq05nkOkszWzVwNDPXkglRUo1sYLVlRUQPBFQYsjTvOGUCT3K4zItTnnRBNRRlMQWDSle5GRAh8wdTmmIS/k2U9g/TH5Lk3zuVmvD/U1HC3tkFSwhQOcCoZPK0rnF9iAQu6gp4aOQCFGCQ6Be8XfhKi3BuPlb2bm4w4gJmCz21AANjPSi+7ND930AZXF1rV1QW/HTkv/IY6mTFTGpT7p3wzCOo/W+3fe1UNchzYcTibAX2f5BPZ0JVdlAWxVC/AbohpYjqeV98//Uw9M0zzyu+VQ3m5sO9M2UdFVdAhDk5jpQ3yWgrGARPJ+lekIyvwrAoiI8kv45skosAlnkyFeBRU3laVVgifjNzWVpWIGfbCCCPqRtXaRaQhL6g92I4a1UksCyXVS7AImnarP+/GEIJk3tSlNfTgdk6twZerBfF4g7YdWPThMXVTwhZ91y9wkOMNIoc5rYX9Rk0ApLuh3ctPTcGI1fX+iTmohdj+glmh1HJQuwH3ewqlkhOVD+AhSCJRJcUrJ4wdLjTGAsYl2kWEpGRynmCTSv7X7OaO3eWF3N923z+R2JOGXa8gcwu9k+lI89y7T0W75uAhuW0WdVmu07xgVWgBUXVckGMa4YGyFe7mDdLjlp3wipbHdPA47+vh1h5UKqmLHvcuW1wPKymHixnCeBFrJq2SrTPy9uZ6yEzjzLQb5Vn3i6a3YWtLS3a5n3fHz6tTlJQVXALr1vrErvHQTG1g8qiUeEX/2G6BERVBZyAGGsRxv92Ge3CBoR5V0dq433QHNv+yG/bhnR/vEaz47QsC0ZjtD+b7kpIlrE+phYtpsIWEpp+R+9gVqxFPAIPgaxJz1UnQc6xKR083PsY/DlSqMXL4/OOPP2majl7cstpXDHc7cl/f4Z/I+Mh7xqwZSbvnmVEV5n2AeefpI3ztKwfcbxb7UPtqoM/+96oM/1eZA/6O8BLsuOkTlR55Z9mstm2824WOpmYvmUdci6TSRxd5F4onJ5CptY7saDb6zQsIXrVtjcBLnpBW4Tbe7GrNE05+tzP1dkW5cMfyrdk+FIfolZJ/PJ+8Z1c9XlxtCZA4fifP/47+A0t7/y86GwAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUWVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9keWVRditNWFQ5alR0a3FVMUNhbk1Ub2IxN2JReHBrTzZZVllabQphN0VGaHpKU3Z4bmwwTHlBZzVOVjlTaEJaSlRxWFpWeStkQlFaVC9xOU84dlNELy9GOGxTSkFURnVHNkZpK1ZOCnltL1FHTHlLT1FPeUJsNWNpK0pHNEtyRmMzQWdVOUFFSkxyVHdOcEhwSkg5QnlBLzd4cnhZTmNEN0JQcisrM2wKSWE5STdCT1dxemwrSXRtbEZLV1MzblJUcWhKcnFXR28vMC9UMWdlVGpiTS9xemZSTHNGbTFONnloNzA2dkVXOApNRm85bngxT3VQOHEwNHgzR1ZwSmN3KzlVTElKVEJhYzBsTS8xMm85Sk84WTlLMHhiQ0FZTkpMVjNTOHZrN0I2CnV1SDBmdmREaWdLdDNaZTFqRUJKbHNGQlh5TGp4eCsrcVlOZkFuR295SkJRdUZGbkJtV0hBelhZdVdOTnVlN0cKQ2NyUWFWTVhMb0pVQVBZYjVYam1LM0RxUjZ0a0lPc3ZhbVh1MjBBL0szS2RpT1BWRm9ENEJUREh6eE9yZVRHSgpsZEZrSjJ4R0N3ZHVNdlN4b2tBcHplcDJIY3NnenR3YmFmKzRmaElKRS9OenFYN3J0eVlvUU9GYVRiWk9wWXNMCllTRktFUHJrVkZRT25ER2ZZU2VZVFJmYTFyL08xZHJUCj1uYW5pCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  remediationAction: enforce
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-sriov-ns
        spec:
          remediationAction: enforce # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          severity: low
          namespaceSelector:
            exclude: ["kube-*"]
            include: ["*"]
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: v1
                kind: Namespace
                metadata:
                  name: openshift-sriov-network-operator
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-sriov-operatorgroup
        spec:
          remediationAction: enforce # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          severity: low
          namespaceSelector:
            exclude: ["kube-*"]
            include: ["*"]
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: operators.coreos.com/v1
                kind: OperatorGroup
                metadata:
                  name: sriov-network-operators
                  namespace: openshift-sriov-network-operator
                spec:
                  targetNamespaces:
                    - openshift-sriov-network-operator
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-sriov-subscription
        spec:
          remediationAction: enforce # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          severity: low
          namespaceSelector:
            exclude: ["kube-*"]
            include: ["*"]
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: operators.coreos.com/v1alpha1
                kind: Subscription
                metadata:
                  name: sriov-network-operator-subscription
                  namespace: openshift-sriov-network-operator
                spec:
                  channel: "4.5"
                  installPlanApproval: Automatic
                  name: sriov-network-operator
                  source: redhat-operators
                  sourceNamespace: openshift-marketplace
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-sriov-operatorconfig
        spec:
          remediationAction: enforce # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          severity: low
          namespaceSelector:
            exclude: ["kube-*"]
            include: ["*"]
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: sriovnetwork.openshift.io/v1
                kind: SriovOperatorConfig
                metadata:
                  name: default
                  namespace: openshift-sriov-network-operator
                spec:
                  enableInjector: true
                  enableOperatorWebhook: true
                  configDaemonNodeSelector:
                    "node-role.kubernetes.io/worker-cnf": ""
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-sriov-operatorconfig
        spec:
          remediationAction: inform # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          severity: low
          namespaceSelector:
            exclude: ["kube-*"]
            include: ["*"]
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: operator.openshift.io/v1
                kind: Network
                metadata:
                  name: cluster
                spec:
                  additionalNetworks:
                    - name: dummy-dhcp-network
                      simpleMacvlanConfig:
                        ipamConfig:
                          type: dhcp
                        master: eth0
                        mode: bridge
                        mtu: 1500
                      type: SimpleMacvlan
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-workercnf-mcp
        spec:
          remediationAction: enforce # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          severity: low
          namespaceSelector:
            exclude: ["kube-*"]
            include: ["*"]
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: machineconfiguration.openshift.io/v1
                kind: MachineConfigPool
                metadata:
                  name: worker-cnf
                  labels:
                    machineconfiguration.openshift.io/role: worker-cnf
                spec:
                  paused: true
                  machineConfigSelector:
                    matchExpressions:
                      - key: machineconfiguration.openshift.io/role
                        operator: In
                        values: [worker, worker-cnf]
                  nodeSelector:
                    matchLabels:
                      node-role.kubernetes.io/worker-cnf: ""
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-sriov
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA+1Z32/bNhB+919BaG9D5KbbAgx6S9NhCLB4QR10D0MeaOpssaZIgaTcGsP+9x0p0ZZsynaConAH30sb8Xi8H993JE1a8Y+gDVcyI5USnK3HqgKZMlEbCzotqaQLKEHaMVdvVm9HSy7zjDx61VEJlubU0mxEiKQlBBup0VytUrSkqVUaR6mUylKL6xinTE5YzFgqc6pzk5HJ/fSJTB/Jr9fX6c3PJ85n1MJCaQ5o4O6B3Ck554taeyfIw0b1VGtKWq2Et5X+RN5RA4JL6JsdmQqYi0/jvJz7b7fM+uyCnCvNAAdzbuhMAKZxToVxX9qsWSgrgV63KUqJmn0CZt/DnEvurfjvTuhL6xYmNvXred0WM2h0ixokUlxpNuMh6iDD0ZMfiC1gN15vYLw3i3BD1Aq05nkOkszWzVwNDPXkglRUo1sYLVlRUQPBFQYsjTvOGUCT3K4zItTnnRBNRRlMQWDSle5GRAh8wdTmmIS/k2U9g/TH5Lk3zuVmvD/U1HC3tkFSwhQOcCoZPK0rnF9iAQu6gp4aOQCFGCQ6Be8XfhKi3BuPlb2bm4w4gJmCz21AANjPSi+7ND930AZXF1rV1QW/HTkv/IY6mTFTGpT7p3wzCOo/W+3fe1UNchzYcTibAX2f5BPZ0JVdlAWxVC/AbohpYjqeV98//Uw9M0zzyu+VQ3m5sO9M2UdFVdAhDk5jpQ3yWgrGARPJ+lekIyvwrAoiI8kv45skosAlnkyFeBRU3laVVgifjNzWVpWIGfbCCCPqRtXaRaQhL6g92I4a1UksCyXVS7AImnarP+/GEIJk3tSlNfTgdk6twZerBfF4g7YdWPThMXVTwhZ91y9wkOMNIoc5rYX9Rk0ApLuh3ctPTcGI1fX+iTmohdj+glmh1HJQuwH3ewqlkhOVD+AhSCJRJcUrJ4wdLjTGAsYl2kWEpGRynmCTSv7X7OaO3eWF3N923z+R2JOGXa8gcwu9k+lI89y7T0W75uAhuW0WdVmu07xgVWgBUXVckGMa4YGyFe7mDdLjlp3wipbHdPA47+vh1h5UKqmLHvcuW1wPKymHixnCeBFrJq2SrTPy9uZ6yEzjzLQb5Vn3i6a3YWtLS3a5n3fHz6tTlJQVXALr1vrErvHQTG1g8qiUeEX/2G6BERVBZyAGGsRxv92Ge3CBoR5V0dq433QHNv+yG/bhnR/vEaz47QsC0ZjtD+b7kpIlrE+phYtpsIWEpp+R+9gVqxFPAIPgaxJz1UnQc6xKR083PsY/DlSqMXL4/OOPP2majl7cstpXDHc7cl/f4Z/I+Mh7xqwZSbvnmVEV5n2AeefpI3ztKwfcbxb7UPtqoM/+96oM/1eZA/6O8BLsuOkTlR55Z9mstm2824WOpmYvmUdci6TSRxd5F4onJ5CptY7saDb6zQsIXrVtjcBLnpBW4Tbe7GrNE05+tzP1dkW5cMfyrdk+FIfolZJ/PJ+8Z1c9XlxtCZA4fifP/47+A0t7/y86GwAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUWVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9keWVRditNWFQ5alR0a3FVMUNhbk1Ub2IxN2JReHBrTzZZVllabQphN0VGaHpKU3Z4bmwwTHlBZzVOVjlTaEJaSlRxWFpWeStkQlFaVC9xOU84dlNELy9GOGxTSkFURnVHNkZpK1ZOCnltL1FHTHlLT1FPeUJsNWNpK0pHNEtyRmMzQWdVOUFFSkxyVHdOcEhwSkg5QnlBLzd4cnhZTmNEN0JQcisrM2wKSWE5STdCT1dxemwrSXRtbEZLV1MzblJUcWhKcnFXR28vMC9UMWdlVGpiTS9xemZSTHNGbTFONnloNzA2dkVXOApNRm85bngxT3VQOHEwNHgzR1ZwSmN3KzlVTElKVEJhYzBsTS8xMm85Sk84WTlLMHhiQ0FZTkpMVjNTOHZrN0I2CnV1SDBmdmREaWdLdDNaZTFqRUJKbHNGQlh5TGp4eCsrcVlOZkFuR295SkJRdUZGbkJtV0hBelhZdVdOTnVlN0cKQ2NyUWFWTVhMb0pVQVBZYjVYam1LM0RxUjZ0a0lPc3ZhbVh1MjBBL0szS2RpT1BWRm9ENEJUREh6eE9yZVRHSgpsZEZrSjJ4R0N3ZHVNdlN4b2tBcHplcDJIY3NnenR3YmFmKzRmaElKRS9OenFYN3J0eVlvUU9GYVRiWk9wWXNMCllTRktFUHJrVkZRT25ER2ZZU2VZVFJmYTFyL08xZHJUCj1uYW5pCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
placementRef:
  name: placement-policy-sriov
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-sriov-operator
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-sriov
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA+1Z32/bNhB+919BaG9D5KbbAgx6S9NhCLB4QR10D0MeaOpssaZIgaTcGsP+9x0p0ZZsynaConAH30sb8Xi8H993JE1a8Y+gDVcyI5USnK3HqgKZMlEbCzotqaQLKEHaMVdvVm9HSy7zjDx61VEJlubU0mxEiKQlBBup0VytUrSkqVUaR6mUylKL6xinTE5YzFgqc6pzk5HJ/fSJTB/Jr9fX6c3PJ85n1MJCaQ5o4O6B3Ck554taeyfIw0b1VGtKWq2Et5X+RN5RA4JL6JsdmQqYi0/jvJz7b7fM+uyCnCvNAAdzbuhMAKZxToVxX9qsWSgrgV63KUqJmn0CZt/DnEvurfjvTuhL6xYmNvXred0WM2h0ixokUlxpNuMh6iDD0ZMfiC1gN15vYLw3i3BD1Aq05nkOkszWzVwNDPXkglRUo1sYLVlRUQPBFQYsjTvOGUCT3K4zItTnnRBNRRlMQWDSle5GRAh8wdTmmIS/k2U9g/TH5Lk3zuVmvD/U1HC3tkFSwhQOcCoZPK0rnF9iAQu6gp4aOQCFGCQ6Be8XfhKi3BuPlb2bm4w4gJmCz21AANjPSi+7ND930AZXF1rV1QW/HTkv/IY6mTFTGpT7p3wzCOo/W+3fe1UNchzYcTibAX2f5BPZ0JVdlAWxVC/AbohpYjqeV98//Uw9M0zzyu+VQ3m5sO9M2UdFVdAhDk5jpQ3yWgrGARPJ+lekIyvwrAoiI8kv45skosAlnkyFeBRU3laVVgifjNzWVpWIGfbCCCPqRtXaRaQhL6g92I4a1UksCyXVS7AImnarP+/GEIJk3tSlNfTgdk6twZerBfF4g7YdWPThMXVTwhZ91y9wkOMNIoc5rYX9Rk0ApLuh3ctPTcGI1fX+iTmohdj+glmh1HJQuwH3ewqlkhOVD+AhSCJRJcUrJ4wdLjTGAsYl2kWEpGRynmCTSv7X7OaO3eWF3N923z+R2JOGXa8gcwu9k+lI89y7T0W75uAhuW0WdVmu07xgVWgBUXVckGMa4YGyFe7mDdLjlp3wipbHdPA47+vh1h5UKqmLHvcuW1wPKymHixnCeBFrJq2SrTPy9uZ6yEzjzLQb5Vn3i6a3YWtLS3a5n3fHz6tTlJQVXALr1vrErvHQTG1g8qiUeEX/2G6BERVBZyAGGsRxv92Ge3CBoR5V0dq433QHNv+yG/bhnR/vEaz47QsC0ZjtD+b7kpIlrE+phYtpsIWEpp+R+9gVqxFPAIPgaxJz1UnQc6xKR083PsY/DlSqMXL4/OOPP2majl7cstpXDHc7cl/f4Z/I+Mh7xqwZSbvnmVEV5n2AeefpI3ztKwfcbxb7UPtqoM/+96oM/1eZA/6O8BLsuOkTlR55Z9mstm2824WOpmYvmUdci6TSRxd5F4onJ5CptY7saDb6zQsIXrVtjcBLnpBW4Tbe7GrNE05+tzP1dkW5cMfyrdk+FIfolZJ/PJ+8Z1c9XlxtCZA4fifP/47+A0t7/y86GwAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUWVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9keWVRditNWFQ5alR0a3FVMUNhbk1Ub2IxN2JReHBrTzZZVllabQphN0VGaHpKU3Z4bmwwTHlBZzVOVjlTaEJaSlRxWFpWeStkQlFaVC9xOU84dlNELy9GOGxTSkFURnVHNkZpK1ZOCnltL1FHTHlLT1FPeUJsNWNpK0pHNEtyRmMzQWdVOUFFSkxyVHdOcEhwSkg5QnlBLzd4cnhZTmNEN0JQcisrM2wKSWE5STdCT1dxemwrSXRtbEZLV1MzblJUcWhKcnFXR28vMC9UMWdlVGpiTS9xemZSTHNGbTFONnloNzA2dkVXOApNRm85bngxT3VQOHEwNHgzR1ZwSmN3KzlVTElKVEJhYzBsTS8xMm85Sk84WTlLMHhiQ0FZTkpMVjNTOHZrN0I2CnV1SDBmdmREaWdLdDNaZTFqRUJKbHNGQlh5TGp4eCsrcVlOZkFuR295SkJRdUZGbkJtV0hBelhZdVdOTnVlN0cKQ2NyUWFWTVhMb0pVQVBZYjVYam1LM0RxUjZ0a0lPc3ZhbVh1MjBBL0szS2RpT1BWRm9ENEJUREh6eE9yZVRHSgpsZEZrSjJ4R0N3ZHVNdlN4b2tBcHplcDJIY3NnenR3YmFmKzRmaElKRS9OenFYN3J0eVlvUU9GYVRiWk9wWXNMCllTRktFUHJrVkZRT25ER2ZZU2VZVFJmYTFyL08xZHJUCj1uYW5pCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: sriov, operator: In, values: ["true"]}
