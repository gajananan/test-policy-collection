apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-trusted-node
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-2 Baseline Configuration
    integrityshield.io/message: H4sIAAAAAAAAA41UPW/bMBDd9SsIzaGbpChQaEvcIsiQIIiDLkWGs3hy2FAkQVJqjKL/vUfKtGVHdcxJIu/zvXcHVv5A56XRFbNGyXo9MxY1r1XnAzregoYVtqjDTJpP/UXxKrWo2EMyLVoMICBAVTCmocUcgwcX3QXXRiC9gdYmQKAsPpqyE1L5AFqAE75i97eLJ7Z4YF/Pz/mXzyf61xBwZZxECjC/Y3OjG7nqXCqC3W1NT41mdHBGpVj8kl2DRyU17octvMU69ufIT8h0d1WHhK3UjXEtvQnpYamQMGxA+QhOhgxbq6joDUKcmeUvrMM3bKSWKUi6jwcOSaMuZ3LZzmrTEkeg7AtcbK0Hxp4GRu6JkA15+X1MYj4DmfgGVBNmNiOZdt83d7z9xx6dDOuKKfP7IJ63UOMCFTVl3NiJEToEu6CMP0uBDXQqlM8jg//jyTkv3qFxooQVlRNvr+lX6tWEmJfDC58Stc3uj9iM5J9vJ30yF9vUj51K42HljTOdrejL+iPVF75Lokga4UdHbptrR9guzYcwvQP2g8ImYE29TSyIowhlPW2S0HgJOVobnNFaCB2NYUl6xnKjkbC2FHkYajE/cL3qQao4cruw+yJsIdQv39+sQ+93qWKyP69ISkbdS2d0rPmMEQQ07OTKbvUZ60F1ccFE2fbl89/iH9Gx4sJPBQAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUUVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9lZzNndi9lSG1pNy9KN2Q0Yk9KVDJsd09Oc0hlTjM5TlhVK0xNTwpQSisydTFOK0dDa0taSWR1YW5zSmdEaThuWUJmQjlnRDRQSHl2bGxyeHhzSUtwWGdyRmU2NWlJeUlHTWdDSkV4CkMrdXQzK2hGaVNtVFNmb2w5L1dsUnIrajFkUS8rNEZ6cjVNcjlhVnlUM3pneWMwT1BOanovTmlmSmw5VTdPOFgKWWFzNXNCWlRNby91b0k0c2RHQTA2N08rbXN6V1hvNWJKVGdkMXhvdzluTWRCUWhSTU85cDNxTTN0cDd1aVA3Rgo4Q2RlMlhNMXROdURvaUtCdENCK2lVd2J3Z2dOTHNsRGgvS01GSSt3bGNqRnNNZWdnVnhKOTRCd3pzdXl0R3VoCkJvd3FqcHFHRFB1KzBBV0k3ckZjMDNBem82bHBPWElsM0ZOdklMTzNJRVgydmNKb3QvQXYrZUZhVUNpODR6ankKTVQ0VVdOWWM0V2xpVXhlTmE3NExBMGs4aDMwZ0RxaGxjdERVaUJWRStlLzBoSlpyVjdOYnM3VW1lOXdJaTVjeQozOHlJUGhsN3pnN2ZXcWI5WStuWCtmNWI4WStCWEZTc3h0WFlqOTNvQmFjYWs2THZEbVpxanVmcTZ2ZkVhRi9RCnEwWEdYOEZVY0hYM1czYTVoVCtqM3drbGZ4QndwSExaCj13Tm1hCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policies.ibm.com/v1alpha1
        kind: TrustedNodePolicy
        metadata:
          name: example-trustednodepolicy
        spec:
          severity: low
          namespaceSelector:
            include: ["default"]
          remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-trusted-node
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA41UPW/bMBDd9SsIzaGbpChQaEvcIsiQIIiDLkWGs3hy2FAkQVJqjKL/vUfKtGVHdcxJIu/zvXcHVv5A56XRFbNGyXo9MxY1r1XnAzregoYVtqjDTJpP/UXxKrWo2EMyLVoMICBAVTCmocUcgwcX3QXXRiC9gdYmQKAsPpqyE1L5AFqAE75i97eLJ7Z4YF/Pz/mXzyf61xBwZZxECjC/Y3OjG7nqXCqC3W1NT41mdHBGpVj8kl2DRyU17octvMU69ufIT8h0d1WHhK3UjXEtvQnpYamQMGxA+QhOhgxbq6joDUKcmeUvrMM3bKSWKUi6jwcOSaMuZ3LZzmrTEkeg7AtcbK0Hxp4GRu6JkA15+X1MYj4DmfgGVBNmNiOZdt83d7z9xx6dDOuKKfP7IJ63UOMCFTVl3NiJEToEu6CMP0uBDXQqlM8jg//jyTkv3qFxooQVlRNvr+lX6tWEmJfDC58Stc3uj9iM5J9vJ30yF9vUj51K42HljTOdrejL+iPVF75Lokga4UdHbptrR9guzYcwvQP2g8ImYE29TSyIowhlPW2S0HgJOVobnNFaCB2NYUl6xnKjkbC2FHkYajE/cL3qQao4cruw+yJsIdQv39+sQ+93qWKyP69ISkbdS2d0rPmMEQQ07OTKbvUZ60F1ccFE2fbl89/iH9Gx4sJPBQAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUUVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9lZzNndi9lSG1pNy9KN2Q0Yk9KVDJsd09Oc0hlTjM5TlhVK0xNTwpQSisydTFOK0dDa0taSWR1YW5zSmdEaThuWUJmQjlnRDRQSHl2bGxyeHhzSUtwWGdyRmU2NWlJeUlHTWdDSkV4CkMrdXQzK2hGaVNtVFNmb2w5L1dsUnIrajFkUS8rNEZ6cjVNcjlhVnlUM3pneWMwT1BOanovTmlmSmw5VTdPOFgKWWFzNXNCWlRNby91b0k0c2RHQTA2N08rbXN6V1hvNWJKVGdkMXhvdzluTWRCUWhSTU85cDNxTTN0cDd1aVA3Rgo4Q2RlMlhNMXROdURvaUtCdENCK2lVd2J3Z2dOTHNsRGgvS01GSSt3bGNqRnNNZWdnVnhKOTRCd3pzdXl0R3VoCkJvd3FqcHFHRFB1KzBBV0k3ckZjMDNBem82bHBPWElsM0ZOdklMTzNJRVgydmNKb3QvQXYrZUZhVUNpODR6ankKTVQ0VVdOWWM0V2xpVXhlTmE3NExBMGs4aDMwZ0RxaGxjdERVaUJWRStlLzBoSlpyVjdOYnM3VW1lOXdJaTVjeQozOHlJUGhsN3pnN2ZXcWI5WStuWCtmNWI4WStCWEZTc3h0WFlqOTNvQmFjYWs2THZEbVpxanVmcTZ2ZkVhRi9RCnEwWEdYOEZVY0hYM1czYTVoVCtqM3drbGZ4QndwSExaCj13Tm1hCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
placementRef:
  name: placement-policy-trusted-node
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-trusted-node
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-trusted-node
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA41UPW/bMBDd9SsIzaGbpChQaEvcIsiQIIiDLkWGs3hy2FAkQVJqjKL/vUfKtGVHdcxJIu/zvXcHVv5A56XRFbNGyXo9MxY1r1XnAzregoYVtqjDTJpP/UXxKrWo2EMyLVoMICBAVTCmocUcgwcX3QXXRiC9gdYmQKAsPpqyE1L5AFqAE75i97eLJ7Z4YF/Pz/mXzyf61xBwZZxECjC/Y3OjG7nqXCqC3W1NT41mdHBGpVj8kl2DRyU17octvMU69ufIT8h0d1WHhK3UjXEtvQnpYamQMGxA+QhOhgxbq6joDUKcmeUvrMM3bKSWKUi6jwcOSaMuZ3LZzmrTEkeg7AtcbK0Hxp4GRu6JkA15+X1MYj4DmfgGVBNmNiOZdt83d7z9xx6dDOuKKfP7IJ63UOMCFTVl3NiJEToEu6CMP0uBDXQqlM8jg//jyTkv3qFxooQVlRNvr+lX6tWEmJfDC58Stc3uj9iM5J9vJ30yF9vUj51K42HljTOdrejL+iPVF75Lokga4UdHbptrR9guzYcwvQP2g8ImYE29TSyIowhlPW2S0HgJOVobnNFaCB2NYUl6xnKjkbC2FHkYajE/cL3qQao4cruw+yJsIdQv39+sQ+93qWKyP69ISkbdS2d0rPmMEQQ07OTKbvUZ60F1ccFE2fbl89/iH9Gx4sJPBQAA
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUUVJIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9lZzNndi9lSG1pNy9KN2Q0Yk9KVDJsd09Oc0hlTjM5TlhVK0xNTwpQSisydTFOK0dDa0taSWR1YW5zSmdEaThuWUJmQjlnRDRQSHl2bGxyeHhzSUtwWGdyRmU2NWlJeUlHTWdDSkV4CkMrdXQzK2hGaVNtVFNmb2w5L1dsUnIrajFkUS8rNEZ6cjVNcjlhVnlUM3pneWMwT1BOanovTmlmSmw5VTdPOFgKWWFzNXNCWlRNby91b0k0c2RHQTA2N08rbXN6V1hvNWJKVGdkMXhvdzluTWRCUWhSTU85cDNxTTN0cDd1aVA3Rgo4Q2RlMlhNMXROdURvaUtCdENCK2lVd2J3Z2dOTHNsRGgvS01GSSt3bGNqRnNNZWdnVnhKOTRCd3pzdXl0R3VoCkJvd3FqcHFHRFB1KzBBV0k3ckZjMDNBem82bHBPWElsM0ZOdklMTzNJRVgydmNKb3QvQXYrZUZhVUNpODR6ankKTVQ0VVdOWWM0V2xpVXhlTmE3NExBMGs4aDMwZ0RxaGxjdERVaUJWRStlLzBoSlpyVjdOYnM3VW1lOXdJaTVjeQozOHlJUGhsN3pnN2ZXcWI5WStuWCtmNWI4WStCWEZTc3h0WFlqOTNvQmFjYWs2THZEbVpxanVmcTZ2ZkVhRi9RCnEwWEdYOEZVY0hYM1czYTVoVCtqM3drbGZ4QndwSExaCj13Tm1hCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
