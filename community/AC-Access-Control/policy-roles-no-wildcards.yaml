apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-disallowed-roles
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: AC Access Control
    policy.open-cluster-management.io/controls: AC-6 Least Privilege
    integrityshield.io/message: H4sIAAAAAAAAA5VVTW8TMRC9768YhUOlqg5FCFTlFgpClQBVbcUF9TBrTxITr72yvdsGxH9n1onz1W3S+rS78/3e7DPW+if5oJ0dQe2Mlouhq8kKaZoQyYsKLU6pIhuH2r1t3xVzbdUIrpNrUVFEhRFHBYDFinIOoXRAY9wDKeGdocB2tNZFjFwpdO7wgnIholXoVRjBj6vbO7i9hovzc/Hh/QvjJUaaOq+JE4wvYSwlhQCXzkZu6qU5lt4pg/gI3whDhGuvW21oSkWoSXbjeA5QOo03ljHBqe3E+YptHRilIYZtgiZQkcuKSFVtuMcVIAJc+Ztk/EwTbXVKkr53B1/LUw5c8sUzT/S08anBFXnZY5vEfA6SKQJy35Re1jEZiHyeBQTewIM2BkoC15L3WimyUC6eRnAA1Oh5plUnW+kDcayOixHM9HS213moUdItGcbS+e2mAOiREVM826/BvClJnA7ud+zaru2KJtiYuOOwJGifuHwESMcGjVbS3aLmLBWzw2s/w5Z2POEA1X2U+xLlEJs4423+kyAazi/CHtW7lN9ss7NmpTH7TefWudxX75q617x0OTk96bV5Cq7xsj/z4VBmsTwSJoQoXr3+K5kyvAjd10/8qu20R7DKpUU8J1x1TnFDky2Zy1+fjcs0rFu4aRIfGeYRP9XhwBRFaNKKJHTEUXld19v8KZtSRyF7AvKR5nogTvP1XAhHkcrKsSrEUqX01jUhgK+B2LAAD+58Q4PVrsT0f31PTanLvdBxi9p0mrtJuysHFUY5+/JY8+aGTamu2N85saiQbbV3tuv7DBgGFk4OhSt7Bi2aprtQOoFoB/f/iv9bOvFHQwcAAA==
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUa1JIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9mZk5Rd0Fwc2IwSFBvcExtOVBnOXJIbkwwbEZsNVJpRXJ0dm1mdQoyUEhPN2xDZEdHNlkxZWx2N2F4aVJ1SEhOK3FhTXhXR1dpM1NjUkxWbjZlNmtYS3laUE9mS001ZFk5dmtkTk5wCllRVy9iVmlubU5MVDZvRnZqMURHVE1wSWh6OW40VXdjcVdDc3ZkTXMvQjBUN1NJT2srdkVGdW9OS21RODRNUncKc3dpeEhmKzFUY1Z5clhRV0M0cjZhL2kwUE00alJCNFV2N0pHOC9tMmJMaGxSQm1pVDFBbE5XcXA0RFZrUll6cgpraUhtVkdWTkVjVWVib3lIclE0NmswMGFtcEgvb1Z5cGdaUVFDSWZRdGhkU1pqL3VqUGpyWitpcisyYlRRS29LCm1zb3RuWTJKOXhRelQzVXYvUkNzNjhURGlub1VwWEg4eVlBOWFpemxsUmpxOUZKdUxEOE1UUVlpVHVsRDJYcTcKdVE3RklqNUtWVHRXRFBVWEQ1bUpiVDBBMGtrUVliRU8raGxqTkt5Uzh1d0h0K0t1RDdNbGhkT1B4NzJpOXoxQgpPSDZWaHJ2WnZmMlkydm5wcytKZnVqdE8zYnQ5SEd0YkdEUHY3MEhucmpwR0pjbFJYYlR1b3k5UmhHb1pzVUdLCk9HVWRMOWxVTGcvMUtOYUFNYnAxcGd0QS9kSkljVW5lCj01S2VJCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-disallowed-roles-sample-role
        spec:
          remediationAction: inform # will be overridden by remediationAction in parent policy
          severity: high
          namespaceSelector:
            exclude: ["kube-*"]
            include: ["default"]
          object-templates:
            - complianceType: mustnothave
              objectDefinition:
                apiVersion: rbac.authorization.k8s.io/v1
                kind: Role
                rules:
                  - apiGroups:
                      - '*'
                    resources:
                      - '*'
                    verbs:
                      - '*'
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-disallowed-roles
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VVTW8TMRC9768YhUOlqg5FCFTlFgpClQBVbcUF9TBrTxITr72yvdsGxH9n1onz1W3S+rS78/3e7DPW+if5oJ0dQe2Mlouhq8kKaZoQyYsKLU6pIhuH2r1t3xVzbdUIrpNrUVFEhRFHBYDFinIOoXRAY9wDKeGdocB2tNZFjFwpdO7wgnIholXoVRjBj6vbO7i9hovzc/Hh/QvjJUaaOq+JE4wvYSwlhQCXzkZu6qU5lt4pg/gI3whDhGuvW21oSkWoSXbjeA5QOo03ljHBqe3E+YptHRilIYZtgiZQkcuKSFVtuMcVIAJc+Ztk/EwTbXVKkr53B1/LUw5c8sUzT/S08anBFXnZY5vEfA6SKQJy35Re1jEZiHyeBQTewIM2BkoC15L3WimyUC6eRnAA1Oh5plUnW+kDcayOixHM9HS213moUdItGcbS+e2mAOiREVM826/BvClJnA7ud+zaru2KJtiYuOOwJGifuHwESMcGjVbS3aLmLBWzw2s/w5Z2POEA1X2U+xLlEJs4423+kyAazi/CHtW7lN9ss7NmpTH7TefWudxX75q617x0OTk96bV5Cq7xsj/z4VBmsTwSJoQoXr3+K5kyvAjd10/8qu20R7DKpUU8J1x1TnFDky2Zy1+fjcs0rFu4aRIfGeYRP9XhwBRFaNKKJHTEUXld19v8KZtSRyF7AvKR5nogTvP1XAhHkcrKsSrEUqX01jUhgK+B2LAAD+58Q4PVrsT0f31PTanLvdBxi9p0mrtJuysHFUY5+/JY8+aGTamu2N85saiQbbV3tuv7DBgGFk4OhSt7Bi2aprtQOoFoB/f/iv9bOvFHQwcAAA==
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUa1JIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9mZk5Rd0Fwc2IwSFBvcExtOVBnOXJIbkwwbEZsNVJpRXJ0dm1mdQoyUEhPN2xDZEdHNlkxZWx2N2F4aVJ1SEhOK3FhTXhXR1dpM1NjUkxWbjZlNmtYS3laUE9mS001ZFk5dmtkTk5wCllRVy9iVmlubU5MVDZvRnZqMURHVE1wSWh6OW40VXdjcVdDc3ZkTXMvQjBUN1NJT2srdkVGdW9OS21RODRNUncKc3dpeEhmKzFUY1Z5clhRV0M0cjZhL2kwUE00alJCNFV2N0pHOC9tMmJMaGxSQm1pVDFBbE5XcXA0RFZrUll6cgpraUhtVkdWTkVjVWVib3lIclE0NmswMGFtcEgvb1Z5cGdaUVFDSWZRdGhkU1pqL3VqUGpyWitpcisyYlRRS29LCm1zb3RuWTJKOXhRelQzVXYvUkNzNjhURGlub1VwWEg4eVlBOWFpemxsUmpxOUZKdUxEOE1UUVlpVHVsRDJYcTcKdVE3RklqNUtWVHRXRFBVWEQ1bUpiVDBBMGtrUVliRU8raGxqTkt5Uzh1d0h0K0t1RDdNbGhkT1B4NzJpOXoxQgpPSDZWaHJ2WnZmMlkydm5wcytKZnVqdE8zYnQ5SEd0YkdEUHY3MEhucmpwR0pjbFJYYlR1b3k5UmhHb1pzVUdLCk9HVWRMOWxVTGcvMUtOYUFNYnAxcGd0QS9kSkljVW5lCj01S2VJCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
placementRef:
  name: placement-policy-disallowed-roles
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-disallowed-roles
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-disallowed-roles
  annotations:
    integrityshield.io/message: H4sIAAAAAAAAA5VVTW8TMRC9768YhUOlqg5FCFTlFgpClQBVbcUF9TBrTxITr72yvdsGxH9n1onz1W3S+rS78/3e7DPW+if5oJ0dQe2Mlouhq8kKaZoQyYsKLU6pIhuH2r1t3xVzbdUIrpNrUVFEhRFHBYDFinIOoXRAY9wDKeGdocB2tNZFjFwpdO7wgnIholXoVRjBj6vbO7i9hovzc/Hh/QvjJUaaOq+JE4wvYSwlhQCXzkZu6qU5lt4pg/gI3whDhGuvW21oSkWoSXbjeA5QOo03ljHBqe3E+YptHRilIYZtgiZQkcuKSFVtuMcVIAJc+Ztk/EwTbXVKkr53B1/LUw5c8sUzT/S08anBFXnZY5vEfA6SKQJy35Re1jEZiHyeBQTewIM2BkoC15L3WimyUC6eRnAA1Oh5plUnW+kDcayOixHM9HS213moUdItGcbS+e2mAOiREVM826/BvClJnA7ud+zaru2KJtiYuOOwJGifuHwESMcGjVbS3aLmLBWzw2s/w5Z2POEA1X2U+xLlEJs4423+kyAazi/CHtW7lN9ss7NmpTH7TefWudxX75q617x0OTk96bV5Cq7xsj/z4VBmsTwSJoQoXr3+K5kyvAjd10/8qu20R7DKpUU8J1x1TnFDky2Zy1+fjcs0rFu4aRIfGeYRP9XhwBRFaNKKJHTEUXld19v8KZtSRyF7AvKR5nogTvP1XAhHkcrKsSrEUqX01jUhgK+B2LAAD+58Q4PVrsT0f31PTanLvdBxi9p0mrtJuysHFUY5+/JY8+aGTamu2N85saiQbbV3tuv7DBgGFk4OhSt7Bi2aprtQOoFoB/f/iv9bOvFHQwcAAA==
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEZCQUFCQ2dBdkZpRUVkZENIUWpWblNBUmhaMytYbTBOT3crQXJsb2NGQW1CSzJUa1JIR2RoYW1GdVFHcHcKTG1saWJTNWpiMjBBQ2drUW0wTk93K0FybG9mZk5Rd0Fwc2IwSFBvcExtOVBnOXJIbkwwbEZsNVJpRXJ0dm1mdQoyUEhPN2xDZEdHNlkxZWx2N2F4aVJ1SEhOK3FhTXhXR1dpM1NjUkxWbjZlNmtYS3laUE9mS001ZFk5dmtkTk5wCllRVy9iVmlubU5MVDZvRnZqMURHVE1wSWh6OW40VXdjcVdDc3ZkTXMvQjBUN1NJT2srdkVGdW9OS21RODRNUncKc3dpeEhmKzFUY1Z5clhRV0M0cjZhL2kwUE00alJCNFV2N0pHOC9tMmJMaGxSQm1pVDFBbE5XcXA0RFZrUll6cgpraUhtVkdWTkVjVWVib3lIclE0NmswMGFtcEgvb1Z5cGdaUVFDSWZRdGhkU1pqL3VqUGpyWitpcisyYlRRS29LCm1zb3RuWTJKOXhRelQzVXYvUkNzNjhURGlub1VwWEg4eVlBOWFpemxsUmpxOUZKdUxEOE1UUVlpVHVsRDJYcTcKdVE3RklqNUtWVHRXRFBVWEQ1bUpiVDBBMGtrUVliRU8raGxqTkt5Uzh1d0h0K0t1RDdNbGhkT1B4NzJpOXoxQgpPSDZWaHJ2WnZmMlkydm5wcytKZnVqdE8zYnQ5SEd0YkdEUHY3MEhucmpwR0pjbFJYYlR1b3k5UmhHb1pzVUdLCk9HVWRMOWxVTGcvMUtOYUFNYnAxcGd0QS9kSkljVW5lCj01S2VJCi0tLS0tRU5EIFBHUCBTSUdOQVRVUkUtLS0tLQo=
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
